<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @project.name %>
</p>
<p>
  <strong>Tasks:</strong>
  <ul>
    <% @tasks.each do |task| %>
      <li><%= link_to task.name, task_url(task) %>, Difficulty Level: <%= task.difficulty_level %></li>
    <% end %>
  </ul>
</p>

<% if @project.owners.include?(current_user) || admin? %>
  <%= form_for @task do |f| %>
    <%= f.hidden_field :project_id, :input_html => { :value => @project.id } %>
    Task name: <%= f.text_field :name %>
    Description: <%= f.text_area :description %>
    Difficulty: <%= f.text_field :difficulty_level %>
    <%= f.submit class: 'btn' %>
  <% end %>


  <% users_array = User.all.map { |user| [user.email, user.id] } %>
  <% users_array.delete_if { |user| user[0] == current_user.email } %>
  <% if !users_array.empty? %>
    <%= form_for @project_user do |f| %>
      <%= f.hidden_field :project_id, :input_html => { :value => @project.id } %>
      <%= f.hidden_field :role, :input_html => { :value => ProjectUser::ROLE[:viewer] } %>
      <%= select_tag(:user_id, options_for_select(users_array)) %>
      <%= f.submit 'Add Viewer', class: 'btn' %>
    <% end %>
  <% end %>

  <%= link_to 'Edit', edit_project_path(@project) %> |

<% end %>

<%= link_to 'Back', projects_path %>
